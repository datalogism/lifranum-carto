# -*- coding: utf-8 -*-
"""
Created on Fri Jan 10 13:32:02 2020

@author: Celian
"""

import spacy
from spacy.matcher import Matcher
from date_extractor import extract_dates
from spacy_lefff import LefffLemmatizer, POSTagger

def GetAuthorsDates(txt):
    spacy_nlp = spacy.load('fr_core_news_sm')
    txt_clean=txt.lower()
    dates = extract_dates(txt_clean)

    french_lemmatizer = LefffLemmatizer()
    spacy_nlp.add_pipe(french_lemmatizer, name='lefff')
    
    doc = spacy_nlp(txt_clean)
  
    matcher = Matcher(spacy_nlp.vocab)
    for d in dates:
        
        pattern = [{"LEMMA": "naître"},{"OP":"*","POS":{"NOT_IN":["PUNCT"]}},{"TEXT":str(d.year)},{"OP":"*","POS":{"NOT_IN":["PUNCT"]}}]
        matcher.add("birth_date_"+str(d), None, pattern)
        pattern = [{"LEMMA": "naissance"},{"OP":"*","POS":{"NOT_IN":["PUNCT"]}},{"TEXT":str(d.year)},{"OP":"*","POS":{"NOT_IN":["PUNCT"]}}]
        matcher.add("birth_date2_"+str(d), None, pattern)
        pattern = [{"LEMMA": "mourir"},{"OP":"*","POS":{"NOT_IN":["PUNCT"]}},{"TEXT":str(d.year)},{"OP":"*","POS":{"NOT_IN":["PUNCT"]}}]
        matcher.add("death_date_"+str(d), None, pattern)
        pattern = [{"LEMMA": "décéder"},{"OP":"*","POS":{"NOT_IN":["PUNCT"]}},{"TEXT":str(d.year)},{"OP":"*","POS":{"NOT_IN":["PUNCT"]}}]
        matcher.add("death_date2_"+str(d), None, pattern)
        pattern = [{"LEMMA": "mort"},{"OP":"*","POS":{"NOT_IN":["PUNCT"]}},{"TEXT":str(d.year)},{"OP":"*","POS":{"NOT_IN":["PUNCT"]}}]
        matcher.add("death_date3_"+str(d), None, pattern)
    matches = matcher(doc)
    
    resp={"birth_date":None,"death_date":None}
    found_dates={"birth_date":[],"death_date":[]}
    for match_id, start, end in matches:
        string_id = spacy_nlp.vocab.strings[match_id] 
        splitted=string_id.split("_")
        if("birth" in string_id):
            found_dates["birth_date"].append(splitted[-1])
        if("death" in string_id):
            found_dates["death_date"].append(splitted[-1])
    found_dates["birth_date"]=list(set(found_dates["birth_date"]))
    found_dates["death_date"]=list(set(found_dates["death_date"]))
    if(len(found_dates["birth_date"])==1):
        resp["birth_date"]=found_dates["birth_date"][0]
    if(len(found_dates["death_date"])==1):
        resp["death_date"]=found_dates["death_date"][0]
    
    return resp

txt=">Poète, romancier, journaliste, critique d’art et homme politique, Philippe Marcelin est né à Port-au-Prince le 11 décembre 1904 dans une famille de diplomate. À son nom de naissance, il ajoute « Thoby », le nom de famille du côté maternel, en hommage à son oncle, Perceval Thoby. Il commence ses études secondaires au Petit Séminaire Collège Saint-Martial de Port-au-Prince et les termine à Paris. Il rentre ensuite à Port-au-Prince où il obtient une licence en Droit. Il est ensuite nommé Secrétaire Général du Ministère des Travaux Publics. Pendant sa longue carrière dans l’administration publique, l’engagement politique, social et littéraire de Thoby-Marcelin l’amène à s’intéresser à la politique et à pratiquer parallèlement les métiers d’écrivain et de journaliste. En 1946, il participe, avec Anthony Lespès, à la création du Parti Socialiste Populaire (PSP), qui sera déclaré illégal, puis fermé, en 1948, sur l’ordre du président Dumarsais Estimé. La même année, Thoby-Marcelin part s’installer aux États-Unis où il travaille comme traducteur à la Pan American Union à Washington D.C. Il se mariera plus tard à une américaine, Eva Ponticello, qui traduira plusieurs de ses textes en anglais. Avant de s’installer définitivement aux États-Unis, Thoby-Marcelin a collaboré à plusieurs journaux et revues en Haïti (Le Matin, Le Nouvelliste, Haïti Journal, Le Petit Impartial, La Nouvelle Ronde, La Revue Indigène, etc.) dans lesquels il a publié des textes de création et des articles de réflexion. Opposé à l’Occupation américaine, comme la plupart des intellectuels haïtiens de la première moitié du 20e siècle, Thoby-Marcelin participe avec Émile Roumer, Normil G. Sylvain, Jacques Roumain, Antonio Vieux, Daniel Heurtelou et Carl Brouard à la création de La Revue Indigène (1927-1928), organe du Mouvement Indigène. Thoby-Marcelin est, selon Michel Fabre, « l’un des plus importants animateurs du mouvement indigène ». C’est en effet dans La Revue Indigène qu’il se fait d’abord connaître par ses poèmes avant-gardistes. Il en publie d’abord quelques uns dans le premier numéro de juillet 1927 ainsi que dans celui de janvier et février 1928 avant les dix parus dans l’Anthologie de la poésie haïtienne « indigène » (1928). Il y fait également paraître deux nouvelles littéraires dont « Les Héroïnes » publiées en trois parties (1927-28) et « Patron, seulement un p’tit boutt… » dans le numéro 5 et 6 de janvier et février 1928. Il collabore également à la revue importante de Jacques Carméleau Antoine, La Relève (1932-1941) où il publie une nouvelle littéraire intitulée « Le triomphe de César Lamorue » (1936) et deux articles portant sur la situation linguistique d’Haïti : « Pour la défense et illustration de la langue créole » (1937) et « Le problème de la langue » (1938). Si la plupart des textes de Thoby-Marcelin sont éparpillés dans des revues et journaux, il nous a également laissé plusieurs publications en volume qui consistent en des recueils de poésies, des contes, des romans et un ouvrage intitulé Panorama de l’art haïtien (1953). À part les poèmes publiés dans les périodiques, l’oeuvre poétique de Thoby-Marcelin est principalement constituée de quatre plaquettes : La Négresse adolescente (1932), Dialogue avec la femme endormie (1941), Lago-Lago (1943) et À Fonds perdu (1953). Son oeuvre de fiction narrative est composée de quatre romans dont trois écrits en collaboration avec son frère, Pierre Marcelin. Leur premier roman, Canapé Vert (1944), a reçu le Prix du Roman Latino-américain. Ils en ont ensuite publié deux autres ensemble : La Bête de Musseau (1946) et Le Crayon de Dieu (1952). Thoby-Marcelin a signé tout seul un quatrième roman, Tous les hommes sont fous (1980), publié après sa mort survenue le 13 août 1975 à Syracus, dans l’État de New York. Précisons que Tous les hommes sont fous avait été publié auparavant en anglais sous le titre de All Men Are Mad (1970) et en espagnol sous celui de Todos los hombres están locos (1971). Son oeuvre Quoiqu’il ait commencé par la poésie, Thoby-Marcelin est surtout connu comme romancier. Alors qu’il existe plusieurs comptes-rendus et études sur ses romans, sa poésie n’est pas suffisamment divulguée, enseignée et enrichie par les commentaires critiques des spécialistes de littérature dans le milieu universitaire. Les quelques remarques critiques sur la poésie de Thoby-Marcelin se trouvent principalement dans Gouraige (1960), Berrou, Raphaël et Pompilus, Pradel (1977), Fowler (1985), Dominique (1999) et naturellement chez les auteurs qui ont préfacé ses recueils à savoir Léon Laleau (1932), Valéry Larbaud (1943), et Georges Castera (2000). L’œuvre de Thoby-Marcelin est dans l’ensemble fortement influencée par les préceptes du Mouvement Indigène. C’est avec ce mouvement culturel que la quête d’une identité culturelle haïtienne distincte de celle de la France a véritablement commencé. Contrairement aux poètes de La Ronde qui voyaient encore en la France leur « métropole intellectuelle », les écrivains du Mouvement Indigène s’opposaient, non seulement à l’occupation militaire américaine, mais aussi à la domination culturelle de la France. Pour résister à l’impérialisme américain et à l’emprise idéologique française, le Mouvement Indigène prônait une littérature typiquement haïtienne, prenant racine dans le riche folklore que le peuple haïtien a hérité de ses ancêtres indiens et africains. Le Mouvement Indigène recommande aux écrivains et aux artistes de puiser leur inspiration dans la réalité locale, dans les traditions et coutumes haïtiennes telles les légendes des contes populaires créoles et le vaudou qui nourrissent l’imaginaire du peuple haïtien, sans pour autant s’enfermer sur eux-mêmes. Dans sa « Chronique-Programme » du premier numéro de La Revue Indigène, Normil Sylvain préconise une ouverture culturelle internationale, particulièrement sur l’Amérique latine et sur l’Europe. Les idées défendues par le Mouvement Indigène se manifestent, de façon explicite, dans les oeuvres de Thoby-Marcelin. On les retrouve non seulement dans ses premiers poèmes publiés dans La Revue Indigène, mais aussi dans ses recueils. Ses textes ancrés, pour la plupart, dans la réalité haïtienne, puisent la matière dont ils sont composés dans le quotidien des gens du peuple. Alimentés par des faits divers, ses poèmes, publiés dans l’Anthologie de la poésie haïtienne « indigène », décrivent des scènes tout à fait banales, mais qui permettent pourtant au poète de bien rendre compte de son milieu. Après nous avoir invité à contempler, dans le poème « Méridienne », le cabicha d’une petite noire en caraco bleu assise sur une dodine dans « la chaude, la calme douceur antillaise », Thoby-Marcelin nous présente le trajet mouvementé « Croix-des-Missions, Port-au-Prince » en ces vers libres : Route blanche et chaude et pierreuse et qui monte et qui descend, Bordée de bayahondes, Branlant. Brimbalant. Brinquebalant un autobus poussif et les volumineuses Mamelles De cette commère qui broute un biscuit. […] La route fait le gros dos. On débouche et sur quel paysage ! Frondaisons de manguiers ouvrent large un lit. Au fleuve vert des cannes à sucre. À la description de ce paysage champêtre, il oppose, dans un autre poème, celle de la « Grand’Rue » bordée de « maisons neuves, […] blanches et carrées » et où « les chauffeurs des locomotives de la HASCO t’apprennent gentiment » par un « Compè ou fou ? » qu’il « ne faut pas rêver dans la rue ». Avec humour et fantaisie, la poésie de Thoby-Marcelin nous donne à contempler des instants par l’évocation ou la description de lieux et de scènes dans lesquels l’indésirable présence américaine est omniprésente. Les références à l’invasion économique et culturelle des États-Unis se retrouvent dans plusieurs de ses poèmes publiés dans l’Anthologie. Quand les jeunes ne vont pas au cinéma pour regarder « Les Mystères de New-York », ils jouent « au tennis », dansent « le charleston » et mâchent du « chewing-gum ». La parole créole est un autre élément important de la poésie de Thoby-Marcelin et on la trouve sous diverses formes. Comme le remarque Georges Castera (2000), elle se présente soit sous forme d’emprunts-transferts comme dans « Merci en pile », « Et ce n’est point lâcheté / Non. C’est prendre garde. », « L’eau amène le vent pousse », soit comme de simples expressions et de mots tirés directement du créole haïtien tels « Compè ou fou ? », « cabicha », « caraco » et « boula », ou des passages entiers en italique comme celui qu’on trouve à la fin du poème « L’Atlas a menti » : Dèhiè mônes gain mônes HEIN? Et lan cate-la Blancs-yo fait Haïti Piti piti con-ça La poésie de Thoby-Marcelin, tout en étant très haïtienne par les sujets traités et cette utilisation intelligente du créole, se laisse toutefois influencée par les poètes novateurs français du début du 20e siècle tels Apollinaire et les surréalistes. Cette influence s’observe non seulement dans la disposition étrange du texte sur la page, mais aussi dans la juxtaposition inattendue de mots, de phrases, d’onomatopées qui créent un bazar digne des surréalistes. S’il est vrai que la poésie de Thoby-Marcelin n’a pas reçu l’attention qu’elle mérite de la part de la critique étrangère, il est tout aussi vrai que ses romans ont été bien reçus à l’étranger. Le prix international obtenu pour Canapé Vert ainsi que les traductions en anglais et en espagnol témoignent de ce succès très vite obtenu à l’extérieur. L’œuvre romanesque de Thoby-Marcelin, qui exploite principalement des thèmes sociaux en rapport principalement avec la masse populaire, s’inscrit, à l’instar de sa poésie, dans le programme du Mouvement Indigène. Les trois premiers romans paysans, qu’il écrit avec son frère, sont considérés à juste titre comme de bons échantillons du roman indigéniste haïtien. Dans Canapé Vert, le premier roman des frères Marcelin, le lecteur est confronté à un récit dont la structure dramatique est difficilement identifiable. De tous les tableaux et les scènes qui se succèdent et les intrigues diverses que les auteurs entremêlent, il est difficile de dégager l’essentiel de ce roman dépourvu d’action logique. L’intérêt de l’aventure amoureuse d’Aladin et de Florina, qui se termine tragiquement, est difficile à démontrer pour la compréhension globale du roman. Selon Berrou et Pompilus (1977), « cette trame fort simple du roman est à peine perceptible, elle n’est qu’un prétexte à peindre différentes scènes de la vie rurale » (Histoire de la littérature haïtienne illustrée par les textes, T.3, 561). Il semble, en effet, que l’intention des auteurs était de fournir au lecteur une description ethnographique du milieu rural haïtien. On y trouve des notations quasi documentaires sur les moeurs et coutumes des paysans telles les veillées funèbres, les enterrements, les coumbites, les combats de coqs, les pratiques religieuses du voudou, celles de la sorcellerie, les possessions, les exorcismes, etc. Les frères Marcelin semblent attribuer la misère du paysan haïtien à sa foi superstitieuse. Dans l’esprit des habitants du Canapé Vert, leur communauté est victime d’une malédiction d’origine surnaturelle à cause d’un pacte que le houngan, Tonton Bossa, a signé avec Baron Samedi. La situation de ces campagnards va de mal en pis lorsque, pour plaire à Florina, Aladin se sépare de Sanite, sa maîtresse. Cette rupture provoque la déchéance de Sanite qui se prostitue dans les corridors du Bois-de-chêne, à Port-au-Prince. Florina quitte, à son tour, Aladin pour se mettre avec Josaphat, le fils de Tonton Bossa. Sanite tente en vain de reconquérir le coeur d’Aladin avant de se donner la mort. Aveuglé par la jalousie, Aladin tue Florina et Josaphat. En fait, presque tous les personnages subissent une fin tragique dans le roman. Tonton Bossa se suicide et sa femme, Mme Bossa, devient folle suite la mort de son mari. Prévillon, le père de Florina, meurt lui aussi, dans des circonstances bizarres. Saoul comme un cochon, il se fait écraser par un arbre qui tombe. Les deux autres romans des Marcelin partagent beaucoup de similarités avec Canapé Vert. Si leur intrigue est mieux construite, ces trois textes se ressemblent à bien des égards. Leur cadre se situe toujours dans une localité rurale non loin de Port-au-Prince. À part Saint-Marc, un peu plus éloigné, Canapé-Vert et Musseau sont assez proches du centre-ville, ce qui permet aux auteurs de mettre en parallèle les conditions de la vie en ville et celles à la campagne. Les trois textes ont également en commun des hougans-sorciers qui sèment la terreur, des êtres surnaturels et des histoires d’amour ou des ménages qui finissent toujours mal pour des raisons obscures. Cette croyance des paysans au surnaturel, que les auteurs présentent comme naïve, est un thème prédominant dans les trois romans. Les auteurs s’appuient sur la récupération des croyances magico-religieuses, des traditions, des mythes et légendes populaires haïtiens. Si, à la manière des naturalistes, les romans des frères Marcelin fournissent de précieuses informations sur le mode de vie haïtien à la campagne, force est de reconnaître qu’ils n’auront insisté que sur les aspects négatifs. Après la lecture de ces romans, le lecteur ne peut s’empêcher de garder en mémoire l’image d’un milieu rural haïtien sordide peuplé d’alcooliques, de débauchés, de vicieux, de meurtriers, de hougans pratiquant la sorcellerie, de superstitieux, et de femmes sans vertu recourant aux pratiques magiques pour conquérir les hommes. On ne trouve dans les romans des Marcelin aucun héros positif, porteur de valeurs et auquel le lecteur aurait envie de s’identifier. Qu’est-ce qui peut bien justifier une telle partialité dans la représentation des paysans haïtiens à travers l’œuvre romanesque des Marcelin ?"
txt2="Thoby-Marcelin a signé tout seul un quatrième roman, Tous les hommes sont fous (1980), publié après sa mort survenue le 13 août 1975 à Syracus, dans l’État de New York"
res=GetAuthorsDates(txt)
res2=GetAuthorsDates(txt2)
